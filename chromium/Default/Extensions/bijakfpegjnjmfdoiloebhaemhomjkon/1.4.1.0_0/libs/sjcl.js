"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};typeof module!="undefined"&&module.exports&&(module.exports=sjcl),sjcl.cipher.aes=function(e){this.h[0][0][0]||this.z();var t,n,r,i,s=this.h[0][4],o=this.h[1];t=e.length;var u=1;if(t!==4&&t!==6&&t!==8)throw new sjcl.exception.invalid("invalid aes key size");this.a=[r=e.slice(0),i=[]];for(e=t;e<4*t+28;e++){n=r[e-1];if(e%t===0||t===8&&e%t===4)n=s[n>>>24]<<24^s[n>>16&255]<<16^s[n>>8&255]<<8^s[n&255],e%t===0&&(n=n<<8^n>>>24^u<<24,u=u<<1^(u>>7)*283);r[e]=r[e-t]^n}for(t=0;e;t++,e--)n=r[t&3?e:e-4],i[t]=e<=4||t<4?n:o[0][s[n>>>24]]^o[1][s[n>>16&255]]^o[2][s[n>>8&255]]^o[3][s[n&255]]},sjcl.cipher.aes.prototype={encrypt:function(e){return this.I(e,0)},decrypt:function(e){return this.I(e,1)},h:[[[],[],[],[],[]],[[],[],[],[],[]]],z:function(){var e=this.h[0],t=this.h[1],n=e[4],r=t[4],i,s,o,u=[],a=[],f,l,c,h;for(i=0;i<256;i++)a[(u[i]=i<<1^(i>>7)*283)^i]=i;for(s=o=0;!n[s];s^=f||1,o=a[o]||1){c=o^o<<1^o<<2^o<<3^o<<4,c=c>>8^c&255^99,n[s]=c,r[c]=s,l=u[i=u[f=u[s]]],h=l*16843009^i*65537^f*257^s*16843008,l=u[c]*257^c*16843008;for(i=0;i<4;i++)e[i][s]=l=l<<24^l>>>8,t[i][c]=h=h<<24^h>>>8}for(i=0;i<5;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)},I:function(e,t){if(e.length!==4)throw new sjcl.exception.invalid("invalid aes block size");var n=this.a[t],r=e[0]^n[0],i=e[t?3:1]^n[1],s=e[2]^n[2];e=e[t?1:3]^n[3];var o,u,a,f=n.length/4-2,l,c=4,h=[0,0,0,0];o=this.h[t];var p=o[0],d=o[1],v=o[2],m=o[3],g=o[4];for(l=0;l<f;l++)o=p[r>>>24]^d[i>>16&255]^v[s>>8&255]^m[e&255]^n[c],u=p[i>>>24]^d[s>>16&255]^v[e>>8&255]^m[r&255]^n[c+1],a=p[s>>>24]^d[e>>16&255]^v[r>>8&255]^m[i&255]^n[c+2],e=p[e>>>24]^d[r>>16&255]^v[i>>8&255]^m[s&255]^n[c+3],c+=4,r=o,i=u,s=a;for(l=0;l<4;l++)h[t?3&-l:l]=g[r>>>24]<<24^g[i>>16&255]<<16^g[s>>8&255]<<8^g[e&255]^n[c++],o=r,r=i,i=s,s=e,e=o;return h}},sjcl.bitArray={bitSlice:function(e,t,n){return e=sjcl.bitArray.P(e.slice(t/32),32-(t&31)).slice(1),n===undefined?e:sjcl.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r=Math.floor(-t-n&31);return((t+n-1^t)&-32?e[t/32|0]<<32-r^e[t/32+1|0]>>>r:e[t/32|0]>>>r)&(1<<n)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var n=e[e.length-1],r=sjcl.bitArray.getPartial(n);return r===32?e.concat(t):sjcl.bitArray.P(t,r,n|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return t===0?0:(t-1)*32+sjcl.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(e.length*32<t)return e;e=e.slice(0,Math.ceil(t/32));var n=e.length;return t&=31,n>0&&t&&(e[n-1]=sjcl.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return e===32?t:(n?t|0:t<<32-e)+e*1099511627776},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(t))return!1;var n=0,r;for(r=0;r<e.length;r++)n|=e[r]^t[r];return n===0},P:function(e,t,n,r){var i;i=0,r===undefined&&(r=[]);for(;t>=32;t-=32)r.push(n),n=0;if(t===0)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=sjcl.bitArray.getPartial(i),r.push(sjcl.bitArray.partial(t+e&31,t+e>32?n:r.pop(),1)),r},k:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}},sjcl.codec.utf8String={fromBits:function(e){var t="",n=sjcl.bitArray.bitLength(e),r,i;for(r=0;r<n/8;r++)(r&3)===0&&(i=e[r/4]),t+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],n,r=0;for(n=0;n<e.length;n++)r=r<<8|e.charCodeAt(n),(n&3)===3&&(t.push(r),r=0);return n&3&&t.push(sjcl.bitArray.partial(8*(n&3),r)),t}},sjcl.codec.hex={fromBits:function(e){var t="",n;for(n=0;n<e.length;n++)t+=((e[n]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(e){var t,n=[],r;e=e.replace(/\s|0x/g,""),r=e.length,e+="00000000";for(t=0;t<e.length;t+=8)n.push(parseInt(e.substr(t,8),16)^0);return sjcl.bitArray.clamp(n,r*4)}},sjcl.codec.base64={F:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var r="",i=0,s=sjcl.codec.base64.F,o=0,u=sjcl.bitArray.bitLength(e);n&&(s=s.substr(0,62)+"-_");for(n=0;r.length*6<u;)r+=s.charAt((o^e[n]>>>i)>>>26),i<6?(o=e[n]<<6-i,i+=26,n++):(o<<=6,i-=6);for(;r.length&3&&!t;)r+="=";return r},toBits:function(e,t){e=e.replace(/\s|=/g,"");var n=[],r=0,i=sjcl.codec.base64.F,s=0,o;t&&(i=i.substr(0,62)+"-_");for(t=0;t<e.length;t++){o=i.indexOf(e.charAt(t));if(o<0)throw new sjcl.exception.invalid("this isn't base64!");r>26?(r-=26,n.push(s^o>>>r),s=o<<32-r):(r+=6,s^=o<<32-r)}return r&56&&n.push(sjcl.bitArray.partial(r&56,s,1)),n}},sjcl.codec.base64url={fromBits:function(e){return sjcl.codec.base64.fromBits(e,1,1)},toBits:function(e){return sjcl.codec.base64.toBits(e,1)}},sjcl.hash.sha256=function(e){this.a[0]||this.z(),e?(this.n=e.n.slice(0),this.i=e.i.slice(0),this.e=e.e):this.reset()},sjcl.hash.sha256.hash=function(e){return(new sjcl.hash.sha256).update(e).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.n=this.N.slice(0),this.i=[],this.e=0,this},update:function(e){typeof e=="string"&&(e=sjcl.codec.utf8String.toBits(e));var t,n=this.i=sjcl.bitArray.concat(this.i,e);t=this.e,e=this.e=t+sjcl.bitArray.bitLength(e);for(t=512+t&-512;t<=e;t+=512)this.D(n.splice(0,16));return this},finalize:function(){var e,t=this.i,n=this.n;t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(1,1)]);for(e=t.length+2;e&15;e++)t.push(0);t.push(Math.floor(this.e/4294967296));for(t.push(this.e|0);t.length;)this.D(t.splice(0,16));return this.reset(),n},N:[],a:[],z:function(){function e(e){return(e-Math.floor(e))*4294967296|0}var t=0,n=2,r;e:for(;t<64;n++){for(r=2;r*r<=n;r++)if(n%r===0)continue e;t<8&&(this.N[t]=e(Math.pow(n,.5))),this.a[t]=e(Math.pow(n,1/3)),t++}},D:function(e){var t,n,r=e.slice(0),i=this.n,s=this.a,o=i[0],u=i[1],a=i[2],f=i[3],l=i[4],c=i[5],h=i[6],p=i[7];for(e=0;e<64;e++)e<16?t=r[e]:(t=r[e+1&15],n=r[e+14&15],t=r[e&15]=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+r[e&15]+r[e+9&15]|0),t=t+p+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(h^l&(c^h))+s[e],p=h,h=c,c=l,l=f+t|0,f=a,a=u,u=o,o=t+(u&a^f&(u^a))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;i[0]=i[0]+o|0,i[1]=i[1]+u|0,i[2]=i[2]+a|0,i[3]=i[3]+f|0,i[4]=i[4]+l|0,i[5]=i[5]+c|0,i[6]=i[6]+h|0,i[7]=i[7]+p|0}},sjcl.mode.ccm={name:"ccm",encrypt:function(e,t,n,r,i){var s,o=t.slice(0),u=sjcl.bitArray,a=u.bitLength(n)/8,f=u.bitLength(o)/8;i=i||64,r=r||[];if(a<7)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&f>>>8*s;s++);return s<15-a&&(s=15-a),n=u.clamp(n,8*(15-s)),t=sjcl.mode.ccm.H(e,t,n,r,i,s),o=sjcl.mode.ccm.J(e,o,n,t,i,s),u.concat(o.data,o.tag)},decrypt:function(e,t,n,r,i){i=i||64,r=r||[];var s=sjcl.bitArray,o=s.bitLength(n)/8,u=s.bitLength(t),a=s.clamp(t,u-i),f=s.bitSlice(t,u-i);u=(u-i)/8;if(o<7)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;t<4&&u>>>8*t;t++);t<15-o&&(t=15-o),n=s.clamp(n,8*(15-t)),a=sjcl.mode.ccm.J(e,a,n,f,i,t),e=sjcl.mode.ccm.H(e,a.data,n,r,i,t);if(!s.equal(a.tag,e))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return a.data},H:function(e,t,n,r,i,s){var o=[],u=sjcl.bitArray,a=u.k;i/=8;if(i%2||i<4||i>16)throw new sjcl.exception.invalid("ccm: invalid tag length");if(r.length>4294967295||t.length>4294967295)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");s=[u.partial(8,(r.length?64:0)|i-2<<2|s-1)],s=u.concat(s,n),s[3]|=u.bitLength(t)/8,s=e.encrypt(s);if(r.length){n=u.bitLength(r)/8,n<=65279?o=[u.partial(16,n)]:n<=4294967295&&(o=u.concat([u.partial(16,65534)],[n])),o=u.concat(o,r);for(r=0;r<o.length;r+=4)s=e.encrypt(a(s,o.slice(r,r+4).concat([0,0,0])))}for(r=0;r<t.length;r+=4)s=e.encrypt(a(s,t.slice(r,r+4).concat([0,0,0])));return u.clamp(s,i*8)},J:function(e,t,n,r,i,s){var o,u=sjcl.bitArray;o=u.k;var a=t.length,f=u.bitLength(t);n=u.concat([u.partial(8,s-1)],n).concat([0,0,0]).slice(0,4),r=u.bitSlice(o(r,e.encrypt(n)),0,i);if(!a)return{tag:r,data:[]};for(o=0;o<a;o+=4)n[3]++,i=e.encrypt(n),t[o]^=i[0],t[o+1]^=i[1],t[o+2]^=i[2],t[o+3]^=i[3];return{tag:r,data:u.clamp(t,f)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(e,t,n,r,i,s){if(sjcl.bitArray.bitLength(n)!==128)throw new sjcl.exception.invalid("ocb iv must be 128 bits");var o,u=sjcl.mode.ocb2.B,a=sjcl.bitArray,f=a.k,l=[0,0,0,0];n=u(e.encrypt(n));var c,h=[];r=r||[],i=i||64;for(o=0;o+4<t.length;o+=4)c=t.slice(o,o+4),l=f(l,c),h=h.concat(f(n,e.encrypt(f(n,c)))),n=u(n);return c=t.slice(o),t=a.bitLength(c),o=e.encrypt(f(n,[0,0,0,t])),c=a.clamp(f(c.concat([0,0,0]),o),t),l=f(l,f(c.concat([0,0,0]),o)),l=e.encrypt(f(l,f(n,u(n)))),r.length&&(l=f(l,s?r:sjcl.mode.ocb2.pmac(e,r))),h.concat(a.concat(c,a.clamp(l,i)))},decrypt:function(e,t,n,r,i,s){if(sjcl.bitArray.bitLength(n)!==128)throw new sjcl.exception.invalid("ocb iv must be 128 bits");i=i||64;var o=sjcl.mode.ocb2.B,u=sjcl.bitArray,a=u.k,f=[0,0,0,0],l=o(e.encrypt(n)),c,h,p=sjcl.bitArray.bitLength(t)-i,d=[];r=r||[];for(n=0;n+4<p/32;n+=4)c=a(l,e.decrypt(a(l,t.slice(n,n+4)))),f=a(f,c),d=d.concat(c),l=o(l);h=p-n*32,c=e.encrypt(a(l,[0,0,0,h])),c=a(c,u.clamp(t.slice(n),h).concat([0,0,0])),f=a(f,c),f=e.encrypt(a(f,a(l,o(l)))),r.length&&(f=a(f,s?r:sjcl.mode.ocb2.pmac(e,r)));if(!u.equal(u.clamp(f,i),u.bitSlice(t,p)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return d.concat(u.clamp(c,h))},pmac:function(e,t){var n,r=sjcl.mode.ocb2.B,i=sjcl.bitArray,s=i.k,o=[0,0,0,0],u=e.encrypt([0,0,0,0]);u=s(u,r(r(u)));for(n=0;n+4<t.length;n+=4)u=r(u),o=s(o,e.encrypt(s(u,t.slice(n,n+4))));return t=t.slice(n),i.bitLength(t)<128&&(u=s(u,r(u)),t=i.concat(t,[-2147483648,0,0,0])),o=s(o,t),e.encrypt(s(r(s(u,r(u))),o))},B:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^(e[0]>>>31)*135]}},sjcl.misc.hmac=function(e,t){this.M=t=t||sjcl.hash.sha256;var n=[[],[]],r=t.prototype.blockSize/32;this.l=[new t,new t],e.length>r&&(e=t.hash(e));for(t=0;t<r;t++)n[0][t]=e[t]^909522486,n[1][t]=e[t]^1549556828;this.l[0].update(n[0]),this.l[1].update(n[1])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(e,t){return e=(new this.M(this.l[0])).update(e,t).finalize(),(new this.M(this.l[1])).update(e).finalize()},sjcl.misc.pbkdf2=function(e,t,n,r,i){n=n||1e3;if(r<0||n<0)throw sjcl.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=sjcl.codec.utf8String.toBits(e)),i=i||sjcl.misc.hmac,e=new i(e);var s,o,u,a,f=[],l=sjcl.bitArray;for(a=1;32*f.length<(r||1);a++){i=s=e.encrypt(l.concat(t,[a]));for(o=1;o<n;o++){s=e.encrypt(s);for(u=0;u<s.length;u++)i[u]^=s[u]}f=f.concat(i)}return r&&(f=l.clamp(f,r)),f},sjcl.random={randomWords:function(e,t){var n=[];t=this.isReady(t);var r;if(t===0)throw new sjcl.exception.notReady("generator isn't seeded");t&2&&this.U(!(t&1));for(t=0;t<e;t+=4)(t+1)%65536===0&&this.L(),r=this.w(),n.push(r[0],r[1],r[2],r[3]);return this.L(),n.slice(0,e)},setDefaultParanoia:function(e){this.t=e},addEntropy:function(e,t,n){n=n||"user";var r,i,s=(new Date).valueOf(),o=this.q[n],u=this.isReady(),a=0;r=this.G[n],r===undefined&&(r=this.G[n]=this.R++),o===undefined&&(o=this.q[n]=0),this.q[n]=(this.q[n]+1)%this.b.length;switch(typeof e){case"number":t===undefined&&(t=1),this.b[o].update([r,this.u++,1,t,s,1,e|0]);break;case"object":n=Object.prototype.toString.call(e);if(n==="[object Uint32Array]"){i=[];for(n=0;n<e.length;n++)i.push(e[n]);e=i}else{n!=="[object Array]"&&(a=1);for(n=0;n<e.length&&!a;n++)typeof e[n]!="number"&&(a=1)}if(!a){if(t===undefined)for(n=t=0;n<e.length;n++)for(i=e[n];i>0;)t++,i>>>=1;this.b[o].update([r,this.u++,2,t,s,e.length].concat(e))}break;case"string":t===undefined&&(t=e.length),this.b[o].update([r,this.u++,3,t,s,e.length]),this.b[o].update(e);break;default:a=1}if(a)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.j[o]+=t,this.f+=t,u===0&&(this.isReady()!==0&&this.K("seeded",Math.max(this.g,this.f)),this.K("progress",this.getProgress()))},isReady:function(e){return e=this.C[e!==undefined?e:this.t],this.g&&this.g>=e?this.j[0]>80&&(new Date).valueOf()>this.O?3:1:this.f>=e?2:0},getProgress:function(e){return e=this.C[e?e:this.t],this.g>=e?1:this.f>e?1:this.f/e},startCollectors:function(){if(!this.m){if(window.addEventListener)window.addEventListener("load",this.o,!1),window.addEventListener("mousemove",this.p,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this.o),document.attachEvent("onmousemove",this.p)}this.m=!0}},stopCollectors:function(){this.m&&(window.removeEventListener?(window.removeEventListener("load",this.o,!1),window.removeEventListener("mousemove",this.p,!1)):window.detachEvent&&(window.detachEvent("onload",this.o),window.detachEvent("onmousemove",this.p)),this.m=!1)},addEventListener:function(e,t){this.r[e][this.Q++]=t},removeEventListener:function(e,t){var n;e=this.r[e];var r=[];for(n in e)e.hasOwnProperty(n)&&e[n]===t&&r.push(n);for(t=0;t<r.length;t++)n=r[t],delete e[n]},b:[new sjcl.hash.sha256],j:[0],A:0,q:{},u:0,G:{},R:0,g:0,f:0,O:0,a:[0,0,0,0,0,0,0,0],d:[0,0,0,0],s:undefined,t:6,m:!1,r:{progress:{},seeded:{}},Q:0,C:[0,48,64,96,128,192,256,384,512,768,1024],w:function(){for(var e=0;e<4;e++){this.d[e]=this.d[e]+1|0;if(this.d[e])break}return this.s.encrypt(this.d)},L:function(){this.a=this.w().concat(this.w()),this.s=new sjcl.cipher.aes(this.a)},T:function(e){this.a=sjcl.hash.sha256.hash(this.a.concat(e)),this.s=new sjcl.cipher.aes(this.a);for(e=0;e<4;e++){this.d[e]=this.d[e]+1|0;if(this.d[e])break}},U:function(e){var t=[],n=0,r;this.O=t[0]=(new Date).valueOf()+3e4;for(r=0;r<16;r++)t.push(Math.random()*4294967296|0);for(r=0;r<this.b.length;r++){t=t.concat(this.b[r].finalize()),n+=this.j[r],this.j[r]=0;if(!e&&this.A&1<<r)break}this.A>=1<<this.b.length&&(this.b.push(new sjcl.hash.sha256),this.j.push(0)),this.f-=n,n>this.g&&(this.g=n),this.A++,this.T(t)},p:function(e){sjcl.random.addEntropy([e.x||e.clientX||e.offsetX||0,e.y||e.clientY||e.offsetY||0],2,"mouse")},o:function(){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")},K:function(e,t){var n;e=sjcl.random.r[e];var r=[];for(n in e)e.hasOwnProperty(n)&&r.push(e[n]);for(n=0;n<r.length;n++)r[n](t)}};try{var s=new Uint32Array(32);crypto.getRandomValues(s),sjcl.random.addEntropy(s,1024,"crypto['getRandomValues']")}catch(t){}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(e,t,n,r){n=n||{},r=r||{};var i=sjcl.json,s=i.c({iv:sjcl.random.randomWords(4,0)},i.defaults),o;i.c(s,n),n=s.adata,typeof s.salt=="string"&&(s.salt=sjcl.codec.base64.toBits(s.salt)),typeof s.iv=="string"&&(s.iv=sjcl.codec.base64.toBits(s.iv));if(!sjcl.mode[s.mode]||!sjcl.cipher[s.cipher]||typeof e=="string"&&s.iter<=100||s.ts!==64&&s.ts!==96&&s.ts!==128||s.ks!==128&&s.ks!==192&&s.ks!==256||s.iv.length<2||s.iv.length>4)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"&&(o=sjcl.misc.cachedPbkdf2(e,s),e=o.key.slice(0,s.ks/32),s.salt=o.salt),typeof t=="string"&&(t=sjcl.codec.utf8String.toBits(t)),typeof n=="string"&&(n=sjcl.codec.utf8String.toBits(n)),o=new sjcl.cipher[s.cipher](e),i.c(r,s),r.key=e,s.ct=sjcl.mode[s.mode].encrypt(o,t,s.iv,n,s.ts),i.encode(s)},decrypt:function(e,t,n,r){n=n||{},r=r||{};var i=sjcl.json;t=i.c(i.c(i.c({},i.defaults),i.decode(t)),n,!0);var s;n=t.adata,typeof t.salt=="string"&&(t.salt=sjcl.codec.base64.toBits(t.salt)),typeof t.iv=="string"&&(t.iv=sjcl.codec.base64.toBits(t.iv));if(!sjcl.mode[t.mode]||!sjcl.cipher[t.cipher]||typeof e=="string"&&t.iter<=100||t.ts!==64&&t.ts!==96&&t.ts!==128||t.ks!==128&&t.ks!==192&&t.ks!==256||!t.iv||t.iv.length<2||t.iv.length>4)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"&&(s=sjcl.misc.cachedPbkdf2(e,t),e=s.key.slice(0,t.ks/32),t.salt=s.salt),typeof n=="string"&&(n=sjcl.codec.utf8String.toBits(n)),s=new sjcl.cipher[t.cipher](e),n=sjcl.mode[t.mode].decrypt(s,t.ct,t.iv,n,t.ts),i.c(r,t),r.key=e,sjcl.codec.utf8String.fromBits(n)},encode:function(e){var t,n="{",r="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");n+=r+'"'+t+'":',r=",";switch(typeof e[t]){case"number":case"boolean":n+=e[t];break;case"string":n+='"'+escape(e[t])+'"';break;case"object":n+='"'+sjcl.codec.base64.fromBits(e[t],1)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return n+"}"},decode:function(e){e=e.replace(/\s/g,"");if(!e.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t={},n,r;for(n=0;n<e.length;n++){if(!(r=e[n].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");t[r[2]]=r[3]?parseInt(r[3],10):r[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(r[4]):unescape(r[4])}return t},c:function(e,t,n){e===undefined&&(e={});if(t===undefined)return e;var r;for(r in t)if(t.hasOwnProperty(r)){if(n&&e[r]!==undefined&&e[r]!==t[r])throw new sjcl.exception.invalid("required parameter overridden");e[r]=t[r]}return e},W:function(e,t){var n={},r;for(r in e)e.hasOwnProperty(r)&&e[r]!==t[r]&&(n[r]=e[r]);return n},V:function(e,t){var n={},r;for(r=0;r<t.length;r++)e[t[r]]!==undefined&&(n[t[r]]=e[t[r]]);return n}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.S={},sjcl.misc.cachedPbkdf2=function(e,t){var n=sjcl.misc.S,r;return t=t||{},r=t.iter||1e3,n=n[e]=n[e]||{},r=n[r]=n[r]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):sjcl.random.randomWords(2,0)},n=t.salt===undefined?r.firstSalt:t.salt,r[n]=r[n]||sjcl.misc.pbkdf2(e,n,t.iter),{key:r[n].slice(0),salt:n.slice(0)}};